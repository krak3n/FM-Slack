#
# CircleCI Configuration
#

# Machine

machine:
  services:
    - docker
  environment:
    REPO: soon/fm-slack
    TAG: $(sed 's/master/latest/;s/\//\-/' <<<$CIRCLE_BRANCH)

# Build the Docker Image - Tagged by branch - removing feature/

dependencies:
  override:
    - docker build -t $REPO:$TAG .

# Run the tests from within a container

test:
  override:
    - docker run -it --name test --net=host $REPO:$TAG make develop && make test
